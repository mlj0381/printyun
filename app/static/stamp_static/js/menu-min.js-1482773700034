$(function(){$("#recharge_a").show();if(!isEmptyValue($("#uId").text())){$("#uNameLabel").show();$("#quit").show();$("#login_btn").hide();$("#register_btn").hide()}else{$("#login_btn").show();$("#register_btn").show();$("#uNameLabel").hide();$("#quit").hide()}});function toPrintJob(){if(isEmptyValue($("#uId").text())){loginDiv();return false}validateIsOnline({confirmHandle:function(){location="../user/toPrintJob.action"}})}function loginDiv(){ShowDiv("loginDiv","loginDivFade");document.getElementById("j_captcha").value="";reloadCaptcha();$(".validate_info span").text("");document.onkeydown=function(b){if(!b){b=window.event}if((b.keyCode||b.which)==13){submitForm()}};$("#rmbUserInfo").poshytip({className:"tip-green",bgImageFrameSize:9,alignY:"bottom"});if($.cookie("rmbUser")=="true"){var a=new Base64();$("#loginName").val(a.decode($.cookie("userName")));$("#passWord").val(a.decode($.cookie("pwd")));$("#remPwd_check").attr("checked",true)}else{$("#loginName").val("");$("#passWord").val("")}if(!isLower10){$("#loginName").focus(function(){$("#loginName_info").text("");return false});$("#loginName").blur(function(){validateLoginName()});$("#j_captcha").focus(function(){$("#j_captcha_info").text("")});$("#j_captcha").blur(function(){validateCaptcha()})}else{if(isEmptyValue($("#loginName").val())){$("#loginName").val("\u8bf7\u586b\u5199\u7528\u6237\u540d")}$("#j_captcha").val("\u8bf7\u586b\u5199\u9a8c\u8bc1\u7801");$("#loginName").focus(function(){if($(this).val()=="\u8bf7\u586b\u5199\u7528\u6237\u540d"){$(this).val("")}$("#loginName_info").text("");return false});$("#loginName").blur(function(){validateLoginNameLowIe()});$("#j_captcha").focus(function(){if($(this).val()=="\u8bf7\u586b\u5199\u9a8c\u8bc1\u7801"){$(this).val("")}$("#j_captcha_info").text("")});$("#j_captcha").blur(function(){validateCaptchaLowIe()})}$("#passWord").focus(function(){$("#passWord_info").text("")});$("#passWord").blur(function(){validatePassWord()})}function registerDiv(){ShowDiv("registerDiv","loginDivFade");document.getElementById("userregistform").reset();$("#questionDef").css("display","block");$("#questionCus").css("display","none");$(".validate_info span").text("");document.onkeydown=function(a){if(!a){a=window.event}if((a.keyCode||a.which)==13){regist()}};$("#custom").click(function(){checkQuestionFS()});$("#regist_btn").click(function(){regist()});if(!isLower10){$("#reg_loginName").focus(function(){$("#reg_loginName_info").text("")});$("#reg_loginName").blur(function(){validateReg_loginName()});$("#questionDef, #questionCus").focus(function(){$("#safeProblem_info").text("")});$("#questionDef, #questionCus").blur(function(){validateSafeProblem()});$("#answer").focus(function(){$("#answer_info").text("")});$("#answer").blur(function(){validateAnswer()})}else{$("#reg_loginName").val("\u8bf7\u586b\u5199\u7528\u6237\u540d");$("#questionCus").val("\u8bf7\u586b\u5199\u5b89\u5168\u95ee\u9898");$("#answer").val("\u8bf7\u586b\u5199\u95ee\u9898\u7b54\u6848");$("#reg_loginName").focus(function(){if($("#reg_loginName").val()=="\u8bf7\u586b\u5199\u7528\u6237\u540d"){$("#reg_loginName").val("")}$("#reg_loginName_info").text("")});$("#reg_loginName").blur(function(){validateReg_loginNameLowIe()});$("#questionDef").focus(function(){$("#safeProblem_info").text("")});$("#questionCus").focus(function(){if($("#questionCus").val()=="\u8bf7\u586b\u5199\u5b89\u5168\u95ee\u9898"){$("#questionCus").val("")}$("#safeProblem_info").text("")});$("#questionDef, #questionCus").blur(function(){validateSafeProblemLowIe()});$("#answer").focus(function(){if($("#answer").val()=="\u8bf7\u586b\u5199\u95ee\u9898\u7b54\u6848"){$("#answer").val("")}$("#answer_info").text("")});$("#answer").blur(function(){validateAnswerLowIe()})}$("#reg_passWord").focus(function(){$("#reg_passWord_info").text("")});$("#reg_passWord").blur(function(){validateReg_passWord()});$("#confirmPwd").focus(function(){$("#confirmPwd_info").text("")});$("#confirmPwd").blur(function(){validateCfmPwd()})}function closeLoginDiv(){CloseDiv("loginDiv","loginDivFade");document.onkeydown=null}function closeRegisterDiv(){CloseDiv("registerDiv","loginDivFade");document.onkeydown=null}function toLoginDiv(){closeRegisterDiv();loginDiv()}function toRegisterDiv(){closeLoginDiv();registerDiv()}function reloadCaptcha(){document.getElementById("captchaImg").src="../userLogin/getImage.action?_dc="+new Date()}function submitForm(){if(!isLower10){if(!validateLoginName()||!validatePassWord()||!validateCaptcha()){return false}}else{if(!validateLoginNameLowIe()||!validatePassWord()||!validateCaptchaLowIe()){return false}}if($("#remPwd_check").is(":checked")){var a=new Base64();$.cookie("rmbUser","true",{expires:365});$.cookie("userName",a.encode($("#loginName").val()),{expires:365});$.cookie("pwd",a.encode($("#passWord").val()),{expires:365})}else{$.cookie("rmbUser","false",{expires:-1});$.cookie("userName","",{expires:-1});$.cookie("pwd","",{expires:-1})}startWait();sendNumber()}function sendNumber(){$.ajax({type:"get",url:"../userLogin/validCode.action",data:{vercode:$$.allTrim($("#j_captcha").val())},success:function(data){data=data.resultInfo;if(data.rsType==TYPE_RESULT.SUCCESS){$.ajax({type:"post",url:"../userLogin/login.action",data:{pname:$$.allTrim($("#loginName").val()),pwd:$$.allTrim($("#passWord").val())},success:function(data){data=data.resultInfo;if(data.rsType==TYPE_RESULT.SUCCESS){data=eval("("+data.rsData+")");$("#uNameLabel").text(data.UName);if($("#rechargeuid").length>0){$("#rechargeuid").html(data.UName)}$("#uId").text(data.uId);$("#uName").text(data.UName);$("#uNameLabel").show();$("#quit").show();$("#login_btn").hide();$("#register_btn").hide();closeLoginDiv();closeWait()}else{if(data.rsType==TYPE_RESULT.WARN){closeWait();$("#err_info").text(data.msg);$("#passWord").val("");$("#passWord").focus();reloadCaptcha();return false}else{closeWait();$("#err_info").text("\u65e0\u6cd5\u767b\u5f55\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458");return false}}}})}else{closeWait();$("#err_info").text(data.msg);$("#j_captcha").val("");$("#j_captcha").focus();reloadCaptcha()}}})}function validateLoginName(){var a=$$.allTrim($("#loginName").val());if(isEmptyValue(a)){$("#loginName_info").text("\u8bf7\u586b\u5199\u7528\u6237\u540d");return false}if(!isValidLength(a,5)){$("#loginName_info").text("\u7528\u6237\u540d\u81f3\u5c11\u4e3a5\u4f4d");return false}if(!isValidReg(a)){$("#loginName_info").text("\u7528\u6237\u540d\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#loginName").val(a);return true}function validatePassWord(){var a=$$.allTrim($("#passWord").val());if(isEmptyValue(a)){$("#passWord_info").text("\u8bf7\u586b\u5199\u5bc6\u7801");return false}if(!isValidReg(a)){$("#passWord_info").text("\u5bc6\u7801\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#passWord").val(a);return true}function validateCaptcha(){var a=$$.allTrim($("#j_captcha").val());if(isEmptyValue(a)){$("#j_captcha_info").text("\u8bf7\u586b\u5199\u9a8c\u8bc1\u7801");return false}if(!isValidReg(a)){$("#j_captcha_info").text("\u9a8c\u8bc1\u7801\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#j_captcha").val(a);return true}function validateLoginNameLowIe(){var a=$$.allTrim($("#loginName").val());if(isEmptyValue(a)||a=="\u8bf7\u586b\u5199\u7528\u6237\u540d"){$("#loginName").val("\u8bf7\u586b\u5199\u7528\u6237\u540d");$("#loginName_info").text("\u8bf7\u586b\u5199\u7528\u6237\u540d");return false}if(!isValidLength(a,5)){$("#loginName_info").text("\u7528\u6237\u540d\u81f3\u5c11\u4e3a5\u4f4d");return false}if(!isValidReg(a)){$("#loginName_info").text("\u7528\u6237\u540d\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#loginName").val(a);return true}function validateCaptchaLowIe(){var a=$$.allTrim($("#j_captcha").val());if(isEmptyValue(a)||a=="\u8bf7\u586b\u5199\u9a8c\u8bc1\u7801"){$("#j_captcha").val("\u8bf7\u586b\u5199\u9a8c\u8bc1\u7801");$("#j_captcha_info").text("\u8bf7\u586b\u5199\u9a8c\u8bc1\u7801");return false}if(!isValidReg(a)){$("#j_captcha_info").text("\u9a8c\u8bc1\u7801\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#j_captcha").val(a);return true}function remPwd_check(){$("#remPwd_check").trigger("click")}function regist(){var a="";if(!isLower10){if(!validateReg_loginName()||!validateReg_passWord()||!validateCfmPwd()||!validateSafeProblem()||!validateAnswer()){return false}}else{if(!validateReg_loginNameLowIe()||!validateReg_passWord()||!validateCfmPwd()||!validateSafeProblemLowIe()||!validateAnswerLowIe()){return false}}if($("#custom").is(":checked")){a=$$.allTrim($("#questionCus").val())}else{a=$("#questionDef").find("option:selected").text()}if(document.getElementById("agreeCheckbox").checked==false){$("#reg_err_info").text("\u5fc5\u987b\u540c\u610f\u6ce8\u518c\u534f\u8bae\u624d\u80fd\u6ce8\u518c");return false}startWait();$.ajax({type:"post",url:"../userLogin/isExistLoginName.action",data:{loginName:$$.allTrim($("#reg_loginName").val())},success:function(b){b=b.resultInfo;if(b.rsType==TYPE_RESULT.SUCCESS){closeWait();$("#reg_err_info").text("\u7528\u6237\u540d\u5df2\u5b58\u5728");return false}else{if(b.rsType==TYPE_RESULT.FAIL){closeWait();$("#reg_err_info").text("\u7cfb\u7edf\u5f02\u5e38");return false}}var c=$("#userregistform").serialize();$.ajax({type:"get",url:"../userLogin/register.action?problem="+a,cache:false,data:c,dataType:"json",success:function(d){closeWait();d=d.resultInfo;if(d.rsType==TYPE_RESULT.SUCCESS){document.getElementById("userregistform").reset();toLoginDiv();closeWait();return false}else{$("#reg_err_info").text("\u6ce8\u518c\u5931\u8d25");return false}}})}})}function checkQuestionFS(){if($("#custom").is(":checked")){$("#questionDef").css("display","none");$("#questionCus").css("display","block")}else{$("#questionDef").css("display","block");$("#questionCus").css("display","none")}}function agreeCheckbox(){$("#agreeCheckbox").trigger("click")}function customClick(){$("#custom").trigger("click");checkQuestionFS();$("#safeProblem_info").text("")}function validateReg_loginName(){var a=$$.allTrim($("#reg_loginName").val());if(isEmptyValue(a)){$("#reg_loginName_info").text("\u8bf7\u586b\u5199\u7528\u6237\u540d");return false}if(!isValidLength(a,5)){$("#reg_loginName_info").text("\u7528\u6237\u540d\u81f3\u5c11\u4e3a5\u4f4d");return false}if(!isValidReg(a)){$("#reg_loginName_info").text("\u7528\u6237\u540d\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#reg_loginName").val(a);return true}function validateReg_passWord(){var a=$$.allTrim($("#reg_passWord").val());if(isEmptyValue(a)){$("#reg_passWord_info").text("\u8bf7\u586b\u5199\u5bc6\u7801");return false}if(!isValidLength(a,6)){$("#reg_passWord_info").text("\u5bc6\u7801\u81f3\u5c11\u4e3a6\u4f4d");return false}if(!isValidReg(a)){$("#reg_passWord_info").text("\u5bc6\u7801\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#reg_passWord").val(a);return true}function validateCfmPwd(){var a=$$.allTrim($("#confirmPwd").val());if(isEmptyValue(a)){$("#confirmPwd_info").text("\u8bf7\u586b\u5199\u786e\u8ba4\u5bc6\u7801");return false}if(!isValidLength(a,6)){$("#confirmPwd_info").text("\u786e\u8ba4\u5bc6\u7801\u81f3\u5c11\u4e3a6\u4f4d");return false}if(!isValidReg(a)){$("#confirmPwd_info").text("\u786e\u8ba4\u5bc6\u7801\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}if($$.allTrim($("#reg_passWord").val())!=$$.allTrim($("#confirmPwd").val())){$("#confirmPwd_info").text("\u4e24\u6b21\u5bc6\u7801\u586b\u5199\u4e0d\u4e00\u81f4");return false}$("#confirmPwd").val(a);return true}function validateSafeProblem(){var a="";if($("#custom").is(":checked")){a=$$.allTrim($("#questionCus").val());if(isEmptyValue(a)){$("#safeProblem_info").text("\u8bf7\u586b\u5199\u9a8c\u8bc1\u95ee\u9898");return false}$("#questionCus").val(a)}else{a=$("#questionDef").find("option:selected").text();if(isEmptyValue($$.allTrim($("#questionDef").val()))){$("#safeProblem_info").text("\u8bf7\u9009\u62e9\u9a8c\u8bc1\u95ee\u9898");return false}}return true}function validateAnswer(){var a=$$.allTrim($("#answer").val());if(isEmptyValue(a)){$("#answer_info").text("\u8bf7\u586b\u5199\u95ee\u9898\u7b54\u6848");return false}if(!isValidReg(a)){$("#answer_info").text("\u95ee\u9898\u7b54\u6848\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#answer").val(a);return true}function validateReg_loginNameLowIe(){var a=$$.allTrim($("#reg_loginName").val());if(isEmptyValue(a)||a=="\u8bf7\u586b\u5199\u7528\u6237\u540d"){$("#reg_loginName").val("\u8bf7\u586b\u5199\u7528\u6237\u540d");$("#reg_loginName_info").text("\u8bf7\u586b\u5199\u7528\u6237\u540d");return false}if(!isValidLength(a,5)){$("#reg_loginName_info").text("\u7528\u6237\u540d\u81f3\u5c11\u4e3a5\u4f4d");return false}if(!isValidReg(a)){$("#reg_loginName_info").text("\u7528\u6237\u540d\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#reg_loginName").val(a);return true}function validateSafeProblemLowIe(){var a="";if($("#custom").is(":checked")){a=$$.allTrim($("#questionCus").val());if(isEmptyValue(a)||a=="\u8bf7\u586b\u5199\u5b89\u5168\u95ee\u9898"){$("#questionCus").val("\u8bf7\u586b\u5199\u5b89\u5168\u95ee\u9898");$("#safeProblem_info").text("\u8bf7\u586b\u5199\u5b89\u5168\u95ee\u9898");return false}$("#questionCus").val(a)}else{a=$("#questionDef").find("option:selected").text();if(isEmptyValue($$.allTrim($("#questionDef").val()))){$("#safeProblem_info").text("\u8bf7\u9009\u62e9\u5b89\u5168\u95ee\u9898");return false}}return true}function validateAnswerLowIe(){var a=$$.allTrim($("#answer").val());if(isEmptyValue(a)||a=="\u8bf7\u586b\u5199\u95ee\u9898\u7b54\u6848"){$("#answer").val("\u8bf7\u586b\u5199\u95ee\u9898\u7b54\u6848");$("#answer_info").text("\u8bf7\u586b\u5199\u95ee\u9898\u7b54\u6848");return false}if(!isValidReg(a)){$("#answer_info").text("\u95ee\u9898\u7b54\u6848\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");return false}$("#answer").val(a);return true};
